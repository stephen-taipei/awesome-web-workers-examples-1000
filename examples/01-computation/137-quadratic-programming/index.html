<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quadratic Programming - Web Worker Example #137</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Quadratic Programming</h1>
            <p class="subtitle">Web Worker Example #137 - Active Set Method</p>
        </header>

        <main>
            <section class="description">
                <h2>About Quadratic Programming</h2>
                <p>Quadratic Programming (QP) optimizes a quadratic objective function subject to linear constraints. It's widely used in portfolio optimization, support vector machines, and control systems. The Active Set Method iteratively identifies which constraints are active at the solution.</p>
                <div class="formula-box">
                    <p><strong>QP Standard Form:</strong></p>
                    <pre class="formula">
Minimize:   f(x) = ½ x^T Q x + c^T x

Subject to: Ax ≤ b        (inequality constraints)
            Ex = d        (equality constraints)
            x ≥ 0         (bound constraints)

Where:
  Q: n×n positive semi-definite matrix (Hessian)
  c: n×1 cost vector
  A: m×n constraint matrix
  b: m×1 constraint bounds

Active Set Method:
1. Start with feasible point x₀, active set W₀
2. Solve equality-constrained QP on active set
3. Compute Lagrange multipliers
4. If all multipliers ≥ 0, check optimality
5. Otherwise, remove constraint with min multiplier
6. Add violated constraint to active set
7. Repeat until convergence

KKT Conditions:
  ∇f(x*) + Σ λᵢ∇gᵢ(x*) = 0
  gᵢ(x*) ≤ 0, λᵢ ≥ 0
  λᵢgᵢ(x*) = 0 (complementary slackness)
                    </pre>
                </div>
            </section>

            <section class="controls">
                <h2>Problem Setup</h2>

                <div class="input-group">
                    <label for="problemSelect">Example Problem:</label>
                    <select id="problemSelect">
                        <option value="portfolio">Portfolio Optimization</option>
                        <option value="svm">SVM-like Problem</option>
                        <option value="leastSquares">Constrained Least Squares</option>
                        <option value="custom">Custom Problem</option>
                    </select>
                </div>

                <div id="customProblem" class="custom-problem hidden">
                    <div class="input-group">
                        <label>Q Matrix (2×2 symmetric positive definite):</label>
                        <div class="matrix-inputs">
                            <input type="number" id="q11" value="2" step="0.1">
                            <input type="number" id="q12" value="0" step="0.1">
                            <input type="number" id="q21" value="0" step="0.1">
                            <input type="number" id="q22" value="2" step="0.1">
                        </div>
                    </div>

                    <div class="input-group">
                        <label>c Vector (linear cost):</label>
                        <div class="coef-inputs">
                            <input type="number" id="c1" value="-2" step="0.1">
                            <input type="number" id="c2" value="-5" step="0.1">
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Constraints (Ax ≤ b):</label>
                        <div class="constraint-row">
                            <input type="number" id="a11" value="1" step="0.1">
                            <span>x₁ +</span>
                            <input type="number" id="a12" value="-2" step="0.1">
                            <span>x₂ ≤</span>
                            <input type="number" id="b1" value="-2" step="0.1">
                        </div>
                        <div class="constraint-row">
                            <input type="number" id="a21" value="-1" step="0.1">
                            <span>x₁ +</span>
                            <input type="number" id="a22" value="-2" step="0.1">
                            <span>x₂ ≤</span>
                            <input type="number" id="b2" value="-6" step="0.1">
                        </div>
                        <div class="constraint-row">
                            <input type="number" id="a31" value="-1" step="0.1">
                            <span>x₁ +</span>
                            <input type="number" id="a32" value="2" step="0.1">
                            <span>x₂ ≤</span>
                            <input type="number" id="b3" value="2" step="0.1">
                        </div>
                    </div>
                </div>

                <div id="problemDescription" class="problem-desc"></div>

                <div class="params-grid">
                    <div class="input-group">
                        <label for="maxIter">Max Iterations:</label>
                        <input type="number" id="maxIter" value="100" min="10" max="1000">
                    </div>

                    <div class="input-group">
                        <label for="tolerance">Tolerance:</label>
                        <input type="number" id="tolerance" value="0.000001" step="0.000001" min="0.0000001">
                    </div>
                </div>

                <div class="button-group">
                    <button id="solveBtn" class="btn btn-primary">Solve QP</button>
                    <button id="resetBtn" class="btn btn-outline">Reset</button>
                </div>
            </section>

            <section id="progressContainer" class="progress-section hidden">
                <div class="progress-bar-container">
                    <div id="progressBar" class="progress-bar"></div>
                </div>
                <p id="progressText" class="progress-text">Solving...</p>
            </section>

            <section class="visualization">
                <h2>Solution Visualization</h2>
                <canvas id="qpCanvas" width="550" height="400"></canvas>
            </section>

            <section id="resultContainer" class="result-section hidden">
                <h2>Solution</h2>
                <div class="results-grid">
                    <div class="result-item">
                        <span class="result-label">Status</span>
                        <span id="status" class="result-value">-</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Optimal x₁</span>
                        <span id="optX1" class="result-value">-</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Optimal x₂</span>
                        <span id="optX2" class="result-value">-</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Optimal Value</span>
                        <span id="optValue" class="result-value">-</span>
                    </div>
                </div>
                <div class="stats-row">
                    <div class="result-item">
                        <span class="result-label">Iterations</span>
                        <span id="iterations" class="result-value">-</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Active Constraints</span>
                        <span id="activeConstraints" class="result-value">-</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Gradient Norm</span>
                        <span id="gradNorm" class="result-value">-</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">KKT Residual</span>
                        <span id="kktResidual" class="result-value">-</span>
                    </div>
                </div>

                <h3>Iteration History</h3>
                <div id="iterationHistory" class="iteration-history"></div>
            </section>
        </main>

        <footer>
            <p><a href="../index.html">Back to Examples</a> | Web Workers Example #137</p>
        </footer>
    </div>
    <script src="main.js"></script>
</body>
</html>
