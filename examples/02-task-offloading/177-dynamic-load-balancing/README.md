# 動態負載均衡 (Dynamic Load Balancing)

本範例展示如何將大量任務動態分配給多個 Web Worker，並比較不同負載均衡策略的效能與資源利用率。

## 功能特點

1.  **多 Worker 管理**：動態創建和管理一個 Worker 池 (可配置 1-8 個 Worker)。
2.  **異質環境模擬**：
    -   每個 Worker 被賦予隨機的「運算能力」(Power)，模擬真實環境中不同裝置或執行緒的效能差異。
    -   任務具有隨機的「複雜度」(執行時間)，模擬真實應用中大小不一的任務。
3.  **多種均衡策略**：
    -   **輪詢 (Round Robin)**：依序分配任務，不考慮 Worker 當前狀態。
    -   **隨機 (Random)**：隨機選擇 Worker，在大規模下趨於均衡。
    -   **最少連接 (Least Connections)**：優先分配給當前負載（未完成任務數）最少的 Worker，這是動態負載均衡最常用的策略。
    -   **加權輪詢 (Weighted Round Robin)**：考慮 Worker 的能力權重，能力強的 Worker 分配更多任務。
4.  **即時視覺化**：透過圖表和儀表板即時顯示每個 Worker 的負載狀態和系統吞吐量。

## 技術重點

-   **任務調度器 (Dispatcher)**：主執行緒作為中央調度器，根據選定的策略決定將任務指派給哪個 Worker。
-   **狀態追蹤**：主執行緒維護每個 Worker 的狀態 (負載量、已完成數)，用於決策。
-   **非同步通訊**：使用 `postMessage` 發送任務並接收完成通知，實現非阻塞的任務處理。

## 使用方式

1.  設定 Worker 數量和任務產生速率。
2.  選擇一種負載均衡策略 (建議從 Round Robin 開始觀察)。
3.  點擊「開始模擬」。
4.  觀察下方的 Worker 負載條和數值。
    -   在 Round Robin 模式下，如果 Worker 能力不同，你會發現能力差的 Worker 累積大量負載（紅色），而能力強的 Worker 則相對閒置，導致系統瓶頸。
    -   切換到 **Least Connections**，你會發現所有 Worker 的負載會趨於平衡，系統總吞吐量通常會提升。

## 效能觀察

透過比較不同策略，可以發現：對於異質性高 (Worker 能力不同、任務大小不同) 的環境，「最少連接」或「資源感知」的策略通常優於簡單的輪詢或隨機分配。
