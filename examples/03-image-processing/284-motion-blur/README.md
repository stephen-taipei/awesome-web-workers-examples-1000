# 運動模糊 (Motion Blur)

本範例展示如何使用 Web Workers 實現影像的運動模糊效果。

## 功能簡介

運動模糊是模擬相機曝光期間物體或相機快速移動所產生的模糊效果。在影像處理中，這通常通過將影像與一個線性方向的卷積核進行卷積來實現。

### 主要功能

1.  **方向控制**：可設定模糊的角度 (0-360度)。
2.  **強度控制**：可設定模糊的距離 (像素)。
3.  **並行處理**：利用 Web Workers 在背景執行密集的卷積運算，保持 UI 流暢。
4.  **核心預覽**：即時視覺化生成的卷積核。

## 技術實現

### 卷積核生成

運動模糊的核心是一個線性結構，權重分佈在一條特定角度的直線上。

1.  根據給定的距離 `d`，建立一個大小約為 `d x d` 的矩陣。
2.  根據給定的角度 `θ`，計算直線在矩陣中的路徑。
3.  使用抗鋸齒算法 (如 Wu's algorithm 的簡化版) 計算路徑上每個像素的權重。
4.  對核心進行正規化，使所有權重之和為 1。

### Web Worker 處理

-   **主執行緒**：負責 UI 互動、圖片讀取與顯示、將參數與圖片數據發送給 Worker。
-   **Worker 執行緒**：
    1.  接收圖片數據 (`ImageData`) 與模糊參數。
    2.  生成運動模糊卷積核。
    3.  執行卷積運算。
    4.  定期回報處理進度。
    5.  將處理後的 `ImageData` 傳回主執行緒 (使用 Transferable Objects 優化效能)。

## 使用方法

1.  點擊上傳區域選擇圖片，或使用拖放功能。
2.  點擊「載入範例圖片」可快速測試。
3.  調整「模糊角度」與「模糊距離」滑桿。
4.  觀察核心預覽的變化。
5.  點擊「套用模糊」開始處理。
6.  處理完成後可下載結果。

## 效能考量

-   運動模糊的計算複雜度與模糊距離成正比 (核心越大，計算量越大)。
-   使用 `Float32Array` 進行核心運算以確保精度。
-   使用 `Uint8ClampedArray` 處理像素數據。
-   卷積運算在 JavaScript 中是計算密集型任務，非常適合移至 Web Worker 執行。
