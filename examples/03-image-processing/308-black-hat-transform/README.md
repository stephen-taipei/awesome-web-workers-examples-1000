# 黑帽變換 (Black-hat Transform)

黑帽變換是一種形態學圖像處理操作，定義為圖像的閉運算結果減去原圖像。

## 原理

1.  **膨脹 (Dilation)**：使用結構元素擴張圖像中的亮區域。
2.  **腐蝕 (Erosion)**：使用結構元素收縮圖像中的亮區域。
3.  **閉運算 (Closing)**：先膨脹後腐蝕。閉運算可以填充物體內部的小孔，連接鄰近物體，平滑邊界。
4.  **黑帽變換**：`BlackHat(f) = Closing(f) - f`。

由於閉運算會消除暗的小細節（因為膨脹先讓亮區吃掉暗區），所以閉運算後的圖像在暗細節處會變亮（或消失）。減去原圖後，剩下的就是被閉運算消除的那些暗細節。因此，黑帽變換常用於提取比周圍背景更暗的特徵，或者用於校正不均勻照明（提取暗背景）。

## 使用方式

1.  上傳圖片。
2.  選擇結構元素形狀（正方形或圓形）。
3.  設定結構元素大小（半徑）。
4.  點擊「應用黑帽變換」。

## 技術實現

*   **Web Worker**：將密集的像素運算移至後台執行緒，避免阻塞 UI。
*   **形態學運算**：實現了基礎的膨脹和腐蝕算法，並組合為閉運算。
*   **像素操作**：直接操作 ImageData 的 Uint8ClampedArray。
